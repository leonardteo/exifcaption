#!/usr/bin/env bash

if [ "$#" -lt 1 ]; then
  echo "Usage: exifcaption photo1 [photo2 ...]"
  exit 1
fi

for f in "$@"; do
  if [ ! -f "$f" ]; then
    echo "File not found: $f" >&2
    continue
  fi

  echo
  echo "$f"

  # Build a caption using real focal length (not 35mm equiv)
  # LensModel Most cameras Best choice (text label)
  # LensID When LensModel missing ExifTool maps numeric IDs â†’ names
  # Lens Last resort composite When all else fails
  # LensInfo  Always available Specs only, not names

  exiftool -api requestall -s3 -p 'ðŸ“¸ ${Model} + ${LensModel}
${FocalLength;$_ =~ s/ mm$//; $_ = sprintf("%.0fmm", $_)} ${ShutterSpeed}s f/$Aperture ISO${ISO}' "$f"

done | tee /dev/stderr | pbcopy
